window.log=function(){if(log.history=log.history||[],log.history.push(arguments),this.console){var n=arguments,t;n.callee=n.callee.caller,t=[].slice.call(n),typeof console.log=="object"?log.apply.call(console.log,console,t):console.log.apply(console,t)}},function(n){function i(){}for(var r="assert,count,debug,dir,dirxml,error,exception,group,groupCollapsed,groupEnd,info,log,markTimeline,profile,profileEnd,time,timeEnd,trace,warn".split(","),t;!!(t=r.pop());)n[t]=n[t]||i}(function(){try{return console.log(),window.console}catch(n){return window.console={}}}());
/*!
 * AmplifyJS 1.1.0 - Core, Store, Request
 * 
 * Copyright 2011 appendTo LLC. (http://appendto.com/team)
 * Dual licensed under the MIT or GPL licenses.
 * http://appendto.com/open-source-licenses
 * 
 * http://amplifyjs.com
 */
/*!
 * Amplify Core 1.1.0
 * 
 * Copyright 2011 appendTo LLC. (http://appendto.com/team)
 * Dual licensed under the MIT or GPL licenses.
 * http://appendto.com/open-source-licenses
 * 
 * http://amplifyjs.com
 */
(function(n){var r=[].slice,i={},u=n.amplify={publish:function(n){var s=r.call(arguments,1),t,u,o,f=0,e;if(!i[n])return!0;for(t=i[n].slice(),o=t.length;f<o;f++)if(u=t[f],e=u.callback.apply(u.context,s),e===!1)break;return e!==!1},subscribe:function(n,t,r,u){var f,s;arguments.length===3&&typeof r=="number"&&(u=r,r=t,t=null),arguments.length===2&&(r=t,t=null),u=u||10;for(var e=0,h=n.split(/\s/),c=h.length,o;e<c;e++){for(n=h[e],o=!1,i[n]||(i[n]=[]),f=i[n].length-1,s={callback:r,context:t,priority:u};f>=0;f--)if(i[n][f].priority<=u){i[n].splice(f+1,0,s),o=!0;break}o||i[n].unshift(s)}return r},unsubscribe:function(n,t){if(i[n])for(var u=i[n].length,r=0;r<u;r++)if(i[n][r].callback===t){i[n].splice(r,1);break}}}})(this);
/*!
 * Amplify Store - Persistent Client-Side Storage 1.1.0
 * 
 * Copyright 2011 appendTo LLC. (http://appendto.com/team)
 * Dual licensed under the MIT or GPL licenses.
 * http://appendto.com/open-source-licenses
 * 
 * http://amplifyjs.com
 */
(function(n,t){function f(n,r){i.addType(n,function(f,e,o){var c,s,v,l,h=e,a=+new Date;if(!f){h={},l=[],v=0;try{for(f=r.length;f=r.key(v++);)u.test(f)&&(s=JSON.parse(r.getItem(f)),s.expires&&s.expires<=a?l.push(f):h[f.replace(u,"")]=s.data);while(f=l.pop())r.removeItem(f)}catch(y){}return h}if(f="__amplify__"+f,e===t)if(c=r.getItem(f),s=c?JSON.parse(c):{expires:-1},s.expires&&s.expires<=a)r.removeItem(f);else return s.data;else if(e===null)r.removeItem(f);else{s=JSON.stringify({data:e,expires:o.expires?a+o.expires:null});try{r.setItem(f,s)}catch(y){i[n]();try{r.setItem(f,s)}catch(y){throw i.error();}}}return h})}var i=n.store=function(n,t,r,u){var u=i.type;return r&&r.type&&r.type in i.types&&(u=r.type),i.types[u](n,t,r||{})},u,r;i.types={},i.type=null,i.addType=function(n,t){i.type||(i.type=n),i.types[n]=t,i[n]=function(t,r,u){return u=u||{},u.type=n,i(t,r,u)}},i.error=function(){return"amplify.store quota exceeded"},u=/^__amplify__/;for(r in{localStorage:1,sessionStorage:1})try{window[r].getItem&&f(r,window[r])}catch(e){}if(window.globalStorage)try{f("globalStorage",window.globalStorage[window.location.hostname]),i.type==="sessionStorage"&&(i.type="globalStorage")}catch(e){}(function(){if(!i.types.localStorage){var n=document.createElement("div"),r="amplify";n.style.display="none",document.getElementsByTagName("head")[0].appendChild(n);try{n.addBehavior("#default#userdata"),n.load(r)}catch(u){n.parentNode.removeChild(n);return}i.addType("userData",function(u,f,e){n.load(r);var s,o,h,v,l,c=f,a=+new Date;if(!u){for(c={},l=[],v=0;s=n.XMLDocument.documentElement.attributes[v++];)o=JSON.parse(s.value),o.expires&&o.expires<=a?l.push(s.name):c[s.name]=o.data;while(u=l.pop())n.removeAttribute(u);return n.save(r),c}if(u=u.replace(/[^-._0-9A-Za-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u37f-\u1fff\u200c-\u200d\u203f\u2040\u2070-\u218f]/g,"-"),f===t)if(s=n.getAttribute(u),o=s?JSON.parse(s):{expires:-1},o.expires&&o.expires<=a)n.removeAttribute(u);else return o.data;else f===null?n.removeAttribute(u):(h=n.getAttribute(u),o=JSON.stringify({data:f,expires:e.expires?a+e.expires:null}),n.setAttribute(u,o));try{n.save(r)}catch(y){h===null?n.removeAttribute(u):n.setAttribute(u,h),i.userData();try{n.setAttribute(u,o),n.save(r)}catch(y){h===null?n.removeAttribute(u):n.setAttribute(u,h);throw i.error();}}return c})}})(),function(){function u(n){return n===t?t:JSON.parse(JSON.stringify(n))}var n={},r={};i.addType("memory",function(i,f,e){return i?f===t?u(n[i]):(r[i]&&(clearTimeout(r[i]),delete r[i]),f===null)?(delete n[i],null):(n[i]=f,e.expires&&(r[i]=setTimeout(function(){delete n[i],delete r[i]},e.expires)),f):u(n)})}()})(this.amplify=this.amplify||{});
/*!
 * Amplify Request 1.1.0
 * 
 * Copyright 2011 appendTo LLC. (http://appendto.com/team)
 * Dual licensed under the MIT or GPL licenses.
 * http://appendto.com/open-source-licenses
 * 
 * http://amplifyjs.com
 */
(function(n){function i(){}function u(n){return{}.toString.call(n)==="[object Function]"}function r(n){var t=!1;return setTimeout(function(){t=!0},1),function(){var i=this,r=arguments;t?n.apply(i,r):setTimeout(function(){n.apply(i,r)},1)}}n.request=function(t,f,e){var o=t||{};typeof o=="string"&&(u(f)&&(e=f,f={}),o={resourceId:t,data:f||{},success:e});var s={abort:i},h=n.request.resources[o.resourceId],c=o.success||i,l=o.error||i;if(o.success=r(function(t,i){i=i||"success",n.publish("request.success",o,t,i),n.publish("request.complete",o,t,i),c(t,i)}),o.error=r(function(t,i){i=i||"error",n.publish("request.error",o,t,i),n.publish("request.complete",o,t,i),l(t,i)}),!h){if(!o.resourceId)throw"amplify.request: no resourceId provided";throw"amplify.request: unknown resourceId: "+o.resourceId;}if(!n.publish("request.before",o)){o.error(null,"abort");return}return n.request.resources[o.resourceId](o,s),s},n.request.types={},n.request.resources={},n.request.define=function(t,i,r){if(typeof i=="string"){if(!(i in n.request.types))throw"amplify.request.define: unknown type: "+i;r.resourceId=t,n.request.resources[t]=n.request.types[i](r)}else n.request.resources[t]=i}})(amplify),function(n,t,i){var u=["status","statusText","responseText","responseXML","readyState"],f=/\{([^\}]+)\}/g,r;n.request.types.ajax=function(r){return r=t.extend({type:"GET"},r),function(f,e){function c(n,r){t.each(u,function(n,t){try{o[t]=s[t]}catch(i){}}),/OK$/.test(o.statusText)&&(o.statusText="success"),n===i&&(n=null),l&&(r="abort"),/timeout|error|abort/.test(r)?o.error(n,r):o.success(n,r),c=t.noop}var s,v=r.url,a=e.abort,h=t.extend(!0,{},r,{data:f.data}),l=!1,o={readyState:0,setRequestHeader:function(n,t){return s.setRequestHeader(n,t)},getAllResponseHeaders:function(){return s.getAllResponseHeaders()},getResponseHeader:function(n){return s.getResponseHeader(n)},overrideMimeType:function(n){return s.overrideMideType(n)},abort:function(){l=!0;try{s.abort()}catch(n){}c(null,"abort")},success:function(n,t){f.success(n,t)},error:function(n,t){f.error(n,t)}};n.publish("request.ajax.preprocess",r,f,h,o),t.extend(h,{success:function(n,t){c(n,t)},error:function(n,t){c(null,t)},beforeSend:function(t,i){s=t,h=i;var u=r.beforeSend?r.beforeSend.call(this,o,h):!0;return u&&n.publish("request.before.ajax",r,f,h,o)}}),t.ajax(h),e.abort=function(){o.abort(),a.call(this)}}},n.subscribe("request.ajax.preprocess",function(n,i,r){var e=[],u=r.data;typeof u!="string"&&(u=t.extend(!0,{},n.data,u),r.url=r.url.replace(f,function(n,t){if(t in u)return e.push(t),u[t]}),t.each(e,function(n,t){delete u[t]}),r.data=u)}),n.subscribe("request.ajax.preprocess",function(n,i,r){var u=r.data,f=n.dataMap;f&&typeof u!="string"&&(t.isFunction(f)?r.data=f(u):(t.each(n.dataMap,function(n,t){n in u&&(u[t]=u[n],delete u[n])}),r.data=u))}),r=n.request.cache={_key:function(n,t,i){function f(){return i.charCodeAt(r++)<<24|i.charCodeAt(r++)<<16|i.charCodeAt(r++)<<8|i.charCodeAt(r++)<<0}i=t+i;for(var e=i.length,r=0,u=f();r<e;)u^=f();return"request-"+n+"-"+u},_default:function(){var n={};return function(t,i,u,f){var e=r._key(i.resourceId,u.url,u.data),o=t.cache,s;if(e in n)return f.success(n[e]),!1;s=f.success,f.success=function(t){n[e]=t,typeof o=="number"&&setTimeout(function(){delete n[e]},o),s.apply(this,arguments)}}}()},n.store&&(t.each(n.store.types,function(t){r[t]=function(i,u,f,e){var o=r._key(u.resourceId,f.url,f.data),s=n.store[t](o),h;if(s)return f.success(s),!1;h=e.success,e.success=function(r){n.store[t](o,r,{expires:i.cache.expires}),h.apply(this,arguments)}}}),r.persist=r[n.store.type]),n.subscribe("request.before.ajax",function(n){var t=n.cache;if(t)return t=t.type||t,r[t in r?t:"_default"].apply(this,arguments)}),n.request.decoders={jsend:function(n,t,i,r,u){n.status==="success"?r(n.data):n.status==="fail"?u(n.data,"fail"):n.status==="error"&&(delete n.status,u(n,"error"))}},n.subscribe("request.before.ajax",function(i,r,u,f){function o(n,t){h(n,t)}function s(n,t){c(n,t)}var h=f.success,c=f.error,e=t.isFunction(i.decoder)?i.decoder:i.decoder in n.request.decoders?n.request.decoders[i.decoder]:n.request.decoders._default;e&&(f.success=function(n,t){e(n,t,f,o,s)},f.error=function(n,t){e(n,t,f,o,s)})})}(amplify,jQuery);(function(n,t){function e(n,t){this._d=n,this._isUTC=!!t}function r(n,t){for(var i=n+"";i.length<t;)i="0"+i;return i}function w(t,i,r,u){var h=typeof i=="string",f=h?{}:i,e,o,s,c;return h&&u&&(f[i]=+u),e=(f.ms||f.milliseconds||0)+(f.s||f.seconds||0)*1e3+(f.m||f.minutes||0)*6e4+(f.h||f.hours||0)*36e5,o=(f.d||f.days||0)+(f.w||f.weeks||0)*7,s=(f.M||f.months||0)+(f.y||f.years||0)*12,e&&t.setTime(+t+e*r),o&&t.setDate(t.getDate()+o*r),s&&(c=t.getDate(),t.setDate(1),t.setMonth(t.getMonth()+s*r),t.setDate(Math.min(new n(t.getFullYear(),t.getMonth()+1,0).getDate(),c))),t}function c(n){return Object.prototype.toString.call(n)==="[object Array]"}function b(t){return new n(t[0],t[1]||0,t[2]||1,t[3]||0,t[4]||0,t[5]||0,t[6]||0)}function l(t,u){function v(u){var b,k;switch(u){case"M":return f+1;case"Mo":return f+1+a(f+1);case"MM":return r(f+1,2);case"MMM":return i.monthsShort[f];case"MMMM":return i.months[f];case"D":return e;case"Do":return e+a(e);case"DD":return r(e,2);case"DDD":return b=new n(h,f,e),k=new n(h,0,1),~~((b-k)/864e5+1.5);case"DDDo":return b=v("DDD"),b+a(b);case"DDDD":return r(v("DDD"),3);case"d":return o;case"do":return o+a(o);case"ddd":return i.weekdaysShort[o];case"dddd":return i.weekdays[o];case"w":return b=new n(h,f,e-o+5),k=new n(b.getFullYear(),0,4),~~((b-k)/6048e5+1.5);case"wo":return b=v("w"),b+a(b);case"ww":return r(v("w"),2);case"YY":return r(h%100,2);case"YYYY":return h;case"a":return s>11?y.pm:y.am;case"A":return s>11?y.PM:y.AM;case"H":return s;case"HH":return r(s,2);case"h":return s%12||12;case"hh":return r(s%12||12,2);case"m":return p;case"mm":return r(p,2);case"s":return w;case"ss":return r(w,2);case"zz":case"z":return(t._d.toString().match(tt)||[""])[0].replace(nt,"");case"Z":return(c<0?"-":"+")+r(~~(Math.abs(c)/60),2)+":"+r(~~(Math.abs(c)%60),2);case"ZZ":return(c<0?"-":"+")+r(~~(10*Math.abs(c)/6),4);case"L":case"LL":case"LLL":case"LLLL":case"LT":return l(t,i.longDateFormat[u]);default:return u.replace(/(^\[)|(\\)|\]$/g,"")}}var f=t.month(),e=t.date(),h=t.year(),o=t.day(),s=t.hours(),p=t.minutes(),w=t.seconds(),c=-t.zone(),a=i.ordinal,y=i.meridiem;return u.replace(g,v)}function a(t,r){function y(n,t){var r;switch(n){case"M":case"MM":u[1]=~~t-1;break;case"MMM":case"MMMM":for(r=0;r<12;r++)if(i.monthsParse[r].test(t)){u[1]=r;break}break;case"D":case"DD":case"DDD":case"DDDD":u[2]=~~t;break;case"YY":t=~~t,u[0]=t+(t>70?1900:2e3);break;case"YYYY":u[0]=~~Math.abs(t);break;case"a":case"A":h=t.toLowerCase()==="pm";break;case"H":case"HH":case"h":case"hh":u[3]=~~t;break;case"m":case"mm":u[4]=~~t;break;case"s":case"ss":u[5]=~~t;break;case"Z":case"ZZ":c=!0,r=(t||"").match(ft),r&&r[1]&&(e=~~r[1]),r&&r[2]&&(o=~~r[2]),r&&r[0]==="+"&&(e=-e,o=-o)}}for(var u=[0,0,1,0,0,0,0],e=0,o=0,c=!1,l=t.match(s),a=r.match(it),v=Math.min(l.length,a.length),h,f=0;f<v;f++)y(a[f],l[f]);return h&&u[3]<12&&(u[3]+=12),h===!1&&u[3]===12&&(u[3]=0),u[3]+=e,u[4]+=o,c?new n(n.UTC.apply({},u)):b(u)}function ot(n,t){for(var u=Math.min(n.length,t.length),f=Math.abs(n.length-t.length),r=0,i=0;i<u;i++)~~n[i]!=~~t[i]&&r++;return r+f}function st(n,t){for(var f,h=n.match(s),c=[],o=99,r,u,i=0;i<t.length;i++)r=a(n,t[i]),u=ot(h,l(new e(r),t[i]).match(s)),u<o&&(o=u,f=r);return f}function ht(t){var r="YYYY-MM-DDT",i;if(rt.exec(t)){for(i=0;i<3;i++)if(p[i][1].exec(t)){r+=p[i][0];break}return a(t,r+"Z")}return new n(t)}function ct(n,t,r){var u=i.relativeTime[n];return typeof u=="function"?u(t||1,!!r,n):u.replace(/%d/i,t||1)}function lt(n,t){var e=u(Math.abs(n)/1e3),r=u(e/60),f=u(r/60),i=u(f/24),o=u(i/365),s=e<45&&["s",e]||r===1&&["m"]||r<45&&["mm",r]||f===1&&["h"]||f<22&&["hh",f]||i===1&&["d"]||i<=25&&["dd",i]||i<=45&&["M"]||i<345&&["MM",u(i/30)]||o===1&&["y"]||["yy",o];return s[2]=t,ct.apply({},s)}function k(n,t){i.fn[n]=function(n){var i=this._isUTC?"UTC":"";return n!=null?(this._d["set"+i+t](n),this):this._d["get"+i+t]()}}var i,u=Math.round,o={},v=typeof module!="undefined",y="months|monthsShort|monthsParse|weekdays|weekdaysShort|longDateFormat|calendar|relativeTime|ordinal|meridiem".split("|"),f,d=/^\/?Date\((\-?\d+)/i,g=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|dddd?|do?|w[o|w]?|YYYY|YY|a|A|hh?|HH?|mm?|ss?|zz?|ZZ?|LT|LL?L?L?)/g,nt=/[^A-Z]/g,tt=/\([A-Za-z ]+\)|:[0-9]{2} [A-Z]{3} /g,it=/(\\)?(MM?M?M?|dd?d?d|DD?D?D?|YYYY|YY|a|A|hh?|HH?|mm?|ss?|ZZ?|T)/g,s=/(\\)?([0-9]+|([a-zA-Z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+|([\+\-]\d\d:?\d\d))/gi,rt=/\d{4}.\d\d.\d\d(T(\d\d(.\d\d(.\d\d)?)?)?([\+\-]\d\d:?\d\d)?)?/,ut="YYYY-MM-DDTHH:mm:ssZ",p=[["HH:mm:ss",/T\d\d:\d\d:\d\d/],["HH:mm",/T\d\d:\d\d/],["HH",/T\d\d/]],ft=/([\+\-]|\d\d)/gi,et="1.5.0",h="Month|Date|Hours|Minutes|Seconds|Milliseconds".split("|");for(i=function(i,r){if(i===null||i==="")return null;var u,f;return i&&i._d instanceof n?u=new n(+i._d):r?u=c(r)?st(i,r):a(i,r):(f=d.exec(i),u=i===t?new n:f?new n(+f[1]):i instanceof n?i:c(i)?b(i):typeof i=="string"?ht(i):new n(i)),new e(u)},i.utc=function(t,r){return c(t)?new e(new n(n.UTC.apply({},t)),!0):r&&t?i(t+" 0",r+" Z").utc():i(t).utc()},i.humanizeDuration=function(n,t,r){var u=+n,e=i.relativeTime,f;switch(t){case"seconds":u*=1e3;break;case"minutes":u*=6e4;break;case"hours":u*=36e5;break;case"days":u*=864e5;break;case"weeks":u*=6048e5;break;case"months":u*=2592e6;break;case"years":u*=31536e6;break;default:r=!!t}return f=lt(u,!r),r?(u<=0?e.past:e.future).replace(/%s/i,f):f},i.version=et,i.defaultFormat=ut,i.lang=function(n,t){var r,u,f,e=[];if(t){for(r=0;r<12;r++)e[r]=new RegExp("^"+t.months[r]+"|^"+t.monthsShort[r].replace(".",""),"i");t.monthsParse=t.monthsParse||e,o[n]=t}if(o[n])for(r=0;r<y.length;r++)u=y[r],i[u]=o[n][u]||i[u];else v&&(f=require("./lang/"+n),i.lang(n,f))},i.lang("en",{months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),longDateFormat:{LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D YYYY",LLL:"MMMM D YYYY LT",LLLL:"dddd, MMMM D YYYY LT"},meridiem:{AM:"AM",am:"am",PM:"PM",pm:"pm"},calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[last] dddd [at] LT",sameElse:"L"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},ordinal:function(n){var t=n%10;return~~(n%100/10)==1?"th":t===1?"st":t===2?"nd":t===3?"rd":"th"}}),i.isMoment=function(n){return n instanceof e},i.fn=e.prototype={clone:function(){return i(this)},valueOf:function(){return+this._d},"native":function(){return this._d},toString:function(){return this._d.toString()},toDate:function(){return this._d},utc:function(){return this._isUTC=!0,this},local:function(){return this._isUTC=!1,this},format:function(n){return l(this,n?n:i.defaultFormat)},add:function(n,t){return this._d=w(this._d,n,1,t),this},subtract:function(n,t){return this._d=w(this._d,n,-1,t),this},diff:function(n,t,r){var e=i(n),c=(this.zone()-e.zone())*6e4,f=this._d-e._d-c,s=this.year()-e.year(),h=this.month()-e.month(),l=this.date()-e.date(),o;return o=t==="months"?s*12+h+l/30:t==="years"?s+h/12:t==="seconds"?f/1e3:t==="minutes"?f/6e4:t==="hours"?f/36e5:t==="days"?f/864e5:t==="weeks"?f/6048e5:f,r?o:u(o)},from:function(n,t){return i.humanizeDuration(this.diff(n),!t)},fromNow:function(n){return this.from(i(),n)},calendar:function(){var n=this.diff(i().sod(),"days",!0),t=i.calendar,u=t.sameElse,r=n<-6?u:n<-1?t.lastWeek:n<0?t.lastDay:n<1?t.sameDay:n<2?t.nextDay:n<7?t.nextWeek:u;return this.format(typeof r=="function"?r.apply(this):r)},isLeapYear:function(){var n=this.year();return n%4==0&&n%100!=0||n%400==0},isDST:function(){return this.zone()<i([this.year()]).zone()||this.zone()<i([this.year(),5]).zone()},day:function(n){var t=this._d.getDay();return n==null?t:this.add({d:n-t})},sod:function(){return this.clone().hours(0).minutes(0).seconds(0).milliseconds(0)},eod:function(){return this.sod().add({d:1,ms:-1})},zone:function(){return this._isUTC?0:this._d.getTimezoneOffset()},daysInMonth:function(){return this.clone().month(this.month()+1).date(0).date()}},f=0;f<h.length;f++)k(h[f].toLowerCase(),h[f]);k("year","FullYear"),v&&(module.exports=i),typeof window!="undefined"&&(window.moment=i),typeof define=="function"&&define.amd&&define("moment",[],function(){return i})})(Date);var Lawnchair=function(){var u,r,i,n,e,t,f;if(!JSON)throw"JSON unavailable! Include http://www.json.org/json2.js to fix.";if(arguments.length<=2&&arguments.length>0)u=typeof arguments[0]=="function"?arguments[0]:arguments[1],r=typeof arguments[0]=="function"?{}:arguments[0];else throw"Incorrect # of ctor args!";if(typeof u!="function")throw"No callback was provided";if(i=this instanceof Lawnchair?this:new Lawnchair(r,u),i.record=r.record||"record",i.name=r.name||"records",r.adapter)n=Lawnchair.adapters[i.indexOf(Lawnchair.adapters,r.adapter)],n=n.valid()?n:undefined;else for(t=0,f=Lawnchair.adapters.length;t<f;t++)if(n=Lawnchair.adapters[t].valid()?Lawnchair.adapters[t]:undefined,n)break;if(!n)throw"No valid adapter.";for(e in n)i[e]=n[e];for(t=0,f=Lawnchair.plugins.length;t<f;t++)Lawnchair.plugins[t].call(i);return i.init(r,u),i};Lawnchair.adapters=[],Lawnchair.adapter=function(n,t){var r,u,i;t.adapter=n,r="adapter valid init keys save batch get exists all remove nuke".split(" "),u=this.prototype.indexOf;for(i in t)if(u(r,i)===-1)throw"Invalid adapter! Nonstandard method: "+i;Lawnchair.adapters.splice(0,0,t)},Lawnchair.plugins=[],Lawnchair.plugin=function(n){for(var t in n)t==="init"?Lawnchair.plugins.push(n[t]):this.prototype[t]=n[t]},Lawnchair.prototype={isArray:Array.isArray||function(n){return Object.prototype.toString.call(n)==="[object Array]"},indexOf:function(n,t,i,r){if(n.indexOf)return n.indexOf(t);for(i=0,r=n.length;i<r;i++)if(n[i]===t)return i;return-1},lambda:function(n){return this.fn(this.record,n)},fn:function(n,t){return typeof t=="string"?new Function(n,t):t},uuid:function(){var n=function(){return((1+Math.random())*65536|0).toString(16).substring(1)};return n()+n()+"-"+n()+"-"+n()+"-"+n()+"-"+n()+n()+n()},each:function(n){var i=this.lambda(n),t,r;if(this.__results)for(t=0,r=this.__results.length;t<r;t++)i.call(this,this.__results[t],t);else this.all(function(n){for(var t=0,r=n.length;t<r;t++)i.call(this,n[t],t)});return this}},Lawnchair.adapter("dom",{valid:function(){return!!window.Storage},init:function(n,t){this.storage=window.localStorage;var i=this;this.indexer={key:i.name+"._index_",all:function(){var n=JSON.parse(i.storage.getItem(this.key));return n==null&&i.storage.setItem(this.key,JSON.stringify([])),JSON.parse(i.storage.getItem(this.key))},add:function(n){var t=this.all();t.push(n),i.storage.setItem(this.key,JSON.stringify(t))},del:function(n){for(var r=this.all(),u=[],t=0,f=r.length;t<f;t++)r[t]!=n&&u.push(r[t]);i.storage.setItem(this.key,JSON.stringify(u))},find:function(n){for(var i=this.all(),t=0,r=i.length;t<r;t++)if(n===i[t])return t;return!1}},t&&this.fn(this.name,t).call(this,this)},save:function(n,t){var i=n.key||this.uuid();return this.indexer.find(i)||this.indexer.add(i),delete n.key,this.storage.setItem(i,JSON.stringify(n)),t&&(n.key=i,this.lambda(t).call(this,n)),this},batch:function(n,t){for(var r=[],i=0,u=n.length;i<u;i++)this.save(n[i],function(n){r.push(n)});return t&&this.lambda(t).call(this,r),this},keys:function(){var n=options.limit||null,t=options.offset||0;callback&&this.lambda(callback).call(this,this.indexer.all())},get:function(n,t){var u,r,f,i;if(this.isArray(n)){for(u=[],r=0,f=n.length;r<f;r++)i=JSON.parse(this.storage.getItem(n[r])),i&&(i.key=n[r],u.push(i));t&&this.lambda(t).call(this,u)}else i=JSON.parse(this.storage.getItem(n)),i&&(i.key=n),t&&this.lambda(t).call(this,i);return this},all:function(n){for(var i=this.indexer.all(),u=[],r,t=0,f=i.length;t<f;t++)r=JSON.parse(this.storage.getItem(i[t])),r.key=i[t],u.push(r);return n&&this.fn(this.name,n).call(this,u),this},remove:function(n,t){var i=typeof n=="string"?n:n.key;return this.indexer.del(i),this.storage.removeItem(i),t&&this.lambda(t).call(this),this},nuke:function(n){return this.all(function(t){for(var i=0,r=t.length;i<r;i++)this.remove(t[i]);n&&this.lambda(n).call(this)}),this}}),Lawnchair.adapter("window-name",function(n,t){var i=window.top.name?JSON.parse(window.top.name):{};return{valid:function(){return typeof window.top.name!="undefined"},init:function(r,u){i[this.name]={index:[],store:{}},n=i[this.name].index,t=i[this.name].store,this.fn(this.name,u).call(this,this)},keys:function(t){return this.fn("keys",t).call(this,n),this},save:function(r,u){var f=r.key||this.uuid();return r.key&&delete r.key,this.exists(f,function(e){e||n.push(f),t[f]=r,window.top.name=JSON.stringify(i),u&&(r.key=f,this.lambda(u).call(this,r))}),this},batch:function(n,t){for(var r=[],i=0,u=n.length;i<u;i++)this.save(n[i],function(n){r.push(n)});return t&&this.lambda(t).call(this,r),this},get:function(n,i){var r,u,f;if(this.isArray(n))for(r=[],u=0,f=n.length;u<f;u++)r.push(t[n[u]]);else r=t[n],r&&(r.key=n);return i&&this.lambda(i).call(this,r),this},exists:function(n,i){return this.lambda(i).call(this,!!t[n]),this},all:function(i){for(var f=[],u,r=0,e=n.length;r<e;r++)u=t[n[r]],u.key=n[r],f.push(u);return this.fn(this.name,i).call(this,f),this},remove:function(r,u){for(var e=this.isArray(r)?r:[r],f=0,o=e.length;f<o;f++)delete t[e[f]],n.splice(this.indexOf(n,e[f]),1);return window.top.name=JSON.stringify(i),u&&this.lambda(u).call(this),this},nuke:function(t){return storage={},n=[],window.top.name=JSON.stringify(i),t&&this.lambda(t).call(this),this}}}());Lawnchair.adapter("indexed-db",function(){function n(n,t){console.log("error in indexed-db adapter!",n,t)}function t(){return window.indexedDB||window.webkitIndexedDB||window.mozIndexedDB||window.oIndexedDB||window.msIndexedDB}return{valid:function(){return!!t()},init:function(i,r){this.idb=t(),this.waiting=[];var f=this.idb.open(this.name),u=this,o=u.fn(u.name,r),e=function(){return o.call(u,u)};f.onsuccess=function(){var r,i;if(u.db=f.result,u.db.version!="1.0")r=u.db.setVersion("1.0"),r.onsuccess=function(){u.store=u.db.createObjectStore("teststore",{autoIncrement:!0});for(var t=0;t<u.waiting.length;t++)u.waiting[t].call(u);u.waiting=[],e()},r.onerror=function(t){console.log("Failed to create objectstore "+t),n(t)};else{for(u.store={},i=0;i<u.waiting.length;i++)u.waiting[i].call(u);u.waiting=[],e()}},f.onerror=n},save:function(t,i){if(!this.store){this.waiting.push(function(){this.save(t,i)});return}var r=this,e=function(n){i&&(t.key=n.target.result,r.lambda(i).call(r,t))},o=this.db.transaction(["teststore"],webkitIDBTransaction.READ_WRITE),u=o.objectStore("teststore"),f=t.key?u.put(t,t.key):u.put(t);return f.onsuccess=e,f.onerror=n,this},batch:function(n,t){for(var r=[],u=!1,f=this,o=function(t){r.push(t),u=r.length===n.length},s=setInterval(function(){u&&(t&&f.lambda(t).call(f,r),clearInterval(s))},200),i=0,e=n.length;i<e;i++)this.save(n[i],o);return this},get:function(t,i){var r,s,f,u,c;if(!this.store){this.waiting.push(function(){this.get(t,i)});return}if(r=this,s=function(n){i&&r.lambda(i).call(r,n.target.result)},this.isArray(t)){var e=[],h=!1,o=t,l=function(n){e.push(n),h=e.length===o.length},a=setInterval(function(){h&&(i&&r.lambda(i).call(r,e),clearInterval(a))},200);for(u=0,c=o.length;u<c;u++)this.get(o[u],l)}else f=this.db.transaction("teststore").objectStore("teststore").get(t),f.onsuccess=s,f.onerror=function(i){console.log("Failed to find "+t),n(i)};return this},all:function(n){if(!this.store){this.waiting.push(function(){this.all(n)});return}var t=this.fn(this.name,n)||undefined,r=this,u=this.db.transaction("teststore").objectStore("teststore"),i=[];return u.openCursor().onsuccess=function(n){var u=n.target.result;u?(i.push(u.value),u.continue()):t&&t.call(r,i)},this},remove:function(t,i){if(!this.store){this.waiting.push(function(){this.remove(t,i)});return}typeof t=="object"&&(t=t.key);var r=this,f=function(){i&&r.lambda(i).call(r)},u=this.db.transaction(["teststore"],webkitIDBTransaction.READ_WRITE).objectStore("teststore").delete(t);return u.onsuccess=f,u.onerror=n,this},nuke:function(t){if(!this.store){this.waiting.push(function(){this.nuke(t)});return}var i=this,r=t?function(){i.lambda(t).call(i)}:function(){};try{this.db.transaction(["teststore"],webkitIDBTransaction.READ_WRITE).objectStore("teststore").clear().onsuccess=r}catch(u){n()}return this}}}())